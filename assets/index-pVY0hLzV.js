const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./dummyChart-BZmTvoEA.js","./echarts-EtKI0Y2T.js","./libs-DaDHWX8D.js","./index-Bd1oa3-l.js","./arcoDesign-DkbNuMsn.js","./index-x1xSowLH.css"])))=>i.map(i=>d[i]);
import{u as j,a as G,g as H,j as Q,k as ke,_ as De,f as de,l as we}from"./index-Bd1oa3-l.js";import{a as D,B as z,ai as F,L as oe,O as _e,F as fe,G as X,as as re,v as he,T as ye,S as be,H as J,a5 as ne,C as M,at as xe,c as Se,E as Oe,U as Ce,Q as Ve,R as Te,V as Ae}from"./arcoDesign-DkbNuMsn.js";import{u as K,E as Y,i as Z,a as se,b as ve,c as ee,d as le,e as ie,f as Pe}from"./echarts-EtKI0Y2T.js";import{f as I,a6 as E,r as P,a as te,c as T,w as ae,a8 as N,j as y,s as v,t,y as a,a2 as e,v as m,x as g,u as Le,l as Ue,a9 as Re,k as Ie,P as Ee,F as $e}from"./libs-DaDHWX8D.js";import{I as Be}from"./index-BzQthmZB.js";async function je(b,o=!1,l){const n=j();await n.serverAvailable;const r=new URLSearchParams({type:"count",field:b,filter:o?"0.01":"0"});l&&r.append("downloader",l);const c=new URL(G(n.endpoint,"api/statistic/analysis/field?"+r.toString()),location.href);return fetch(c,{headers:H()}).then(u=>(n.assertResponseLogin(u),u.json()))}async function ze(b,o,l,n){const r=j();await r.serverAvailable;const c=new URL(G(r.endpoint,"api/chart/geoIpInfo"),location.href),u=b.getTime(),_=o.getTime();return c.searchParams.append("startAt",u.toString()),c.searchParams.append("endAt",_.toString()),c.searchParams.append("bannedOnly",String(l)),n&&c.searchParams.append("downloader",n),fetch(c,{headers:H()}).then(h=>(r.assertResponseLogin(h),h.json()))}async function Fe(b,o,l){const n=j();await n.serverAvailable;const r=new URLSearchParams({startAt:b.getTime().toString(),endAt:o.getTime().toString()});l&&r.append("downloader",l);const c=new URL(G(n.endpoint,"api/statistic/analysis/banTrends?"+r.toString()),location.href);return fetch(c,{headers:H()}).then(u=>(n.assertResponseLogin(u),u.json()))}async function Me(b,o,l){const n=j();await n.serverAvailable;const r=new URLSearchParams({startAt:b.getTime().toString(),endAt:o.getTime().toString()});l&&r.append("downloader",l);const c=new URL(G(n.endpoint,"api/chart/trend?"+r.toString()),location.href);return fetch(c,{headers:H()}).then(u=>(n.assertResponseLogin(u),u.json()))}async function Ne(b,o,l){const n=j();await n.serverAvailable;const r=new URLSearchParams({startAt:b.getTime().toString(),endAt:o.getTime().toString()});l&&r.append("downloader",l);const c=new URL(G(n.endpoint,"api/chart/traffic?"+r.toString()),location.href);return fetch(c,{headers:H()}).then(u=>(n.assertResponseLogin(u),u.json()))}const ce=I({__name:"ispPie",props:{downloader:{}},setup(b){const{t:o}=E();K([Z,se,ve,ee]);const l=Q(),n=P(),r=te({field:"isp",enableThreshold:!0,bannedOnly:!0,range:[D().startOf("day").add(-14,"day").toDate(),new Date]}),c=T(()=>({text:o("page.charts.loading"),color:l.isDark?"rgb(60, 126, 255)":"rgb(22, 93, 255)",textColor:l.isDark?"rgba(255, 255, 255, 0.9)":"rgb(29, 33, 41)",maskColor:l.isDark?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.4)"})),u=T(()=>_.value),_=P({tooltip:{trigger:"item",appendToBody:!0,formatter:'<p style="word-wrap:break-all"><b>{b}</b></p>  {c} ({d}%)',backgroundColor:l.isDark?"#333335":"",borderColor:l.isDark?"#333335":"",textStyle:{color:l.isDark?"rgba(255, 255, 255, 0.7)":""}},legend:{orient:"vertical",left:"right",type:"scroll",right:10,top:20,bottom:20,data:[],textStyle:{overflow:"truncate",width:100},tooltip:{show:!0}},backgroundColor:l.isDark?"rgba(0, 0, 0, 0.0)":void 0,series:[{name:"",type:"pie",radius:"55%",center:["50%","60%"],data:[],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]});ae(r,d=>{w(d.range[0],d.range[1],r.bannedOnly,h.downloader)});const h=b,{loading:x,run:w,refresh:O}=N(ze,{defaultParams:[D().startOf("day").add(-7,"day").toDate(),new Date,r.bannedOnly,h.downloader],onSuccess:d=>{if(d.data){const s=d.data[r.field];let i;if(r.enableThreshold){const k=s.reduce((f,V)=>f+V.value,0)*.01;i=s.filter(f=>f.value>=k)}else i=s;_.value.legend.data=i.map(p=>p.key),_.value.series[0].data=i.map(p=>({name:p.key==="N/A"&&r.field==="province"?o("page.charts.data.province.na"):p.key,value:p.value})),_.value.series[0].name=o("page.charts.options.field."+r.field)}},onError:d=>{n.value=d}});return(d,s)=>{const i=z,p=F,k=oe,f=_e,V=fe,S=X,A=re,L=he,U=ye,$=be,q=J,W=ne,R=M;return y(),v(R,{hoverable:"",title:e(o)("page.charts.title.geoip")+(r.bannedOnly?e(o)("page.charts.subtitle.bannedOnly"):"")},{extra:t(()=>[a(W,null,{content:t(()=>[a(q,{model:r},{default:t(()=>[a(S,{field:"field",label:e(o)("page.charts.options.field")},{default:t(()=>[a(V,{modelValue:r.field,"onUpdate:modelValue":s[1]||(s[1]=C=>r.field=C),"trigger-props":{autoFitPopupMinWidth:!0}},{default:t(()=>[a(f,{value:"isp"},{default:t(()=>[m(g(e(o)("page.charts.options.field.isp")),1)]),_:1}),a(f,{value:"province"},{default:t(()=>[m(g(e(o)("page.charts.options.field.province")),1)]),_:1}),a(f,{value:"city"},{default:t(()=>[m(g(e(o)("page.charts.options.field.city")),1)]),_:1}),a(f,{value:"region"},{default:t(()=>[m(g(e(o)("page.charts.options.field.region")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(S,{field:"range",label:e(o)("page.charts.options.days")},{default:t(()=>[a(A,{modelValue:r.range,"onUpdate:modelValue":s[2]||(s[2]=C=>r.range=C),"show-time":"","value-format":"Date",shortcuts:[{label:e(o)("page.charts.options.shortcut.7days"),value:()=>[e(D)().startOf("day").add(-7,"day").toDate(),new Date]},{label:e(o)("page.charts.options.shortcut.14days"),value:()=>[e(D)().startOf("day").add(-14,"day").toDate(),new Date]},{label:e(o)("page.charts.options.shortcut.30days"),value:()=>[e(D)().startOf("day").add(-30,"day").toDate(),new Date]}]},null,8,["modelValue","shortcuts"])]),_:1},8,["label"]),a(S,{field:"enableThreshold"},{default:t(()=>[a($,null,{default:t(()=>[a(L,{modelValue:r.enableThreshold,"onUpdate:modelValue":s[3]||(s[3]=C=>r.enableThreshold=C)},null,8,["modelValue"]),a(U,null,{default:t(()=>[m(g(e(o)("page.charts.options.thresold")),1)]),_:1})]),_:1})]),_:1}),a(S,{field:"bannedOnly"},{default:t(()=>[a($,null,{default:t(()=>[a(L,{modelValue:r.bannedOnly,"onUpdate:modelValue":s[4]||(s[4]=C=>r.bannedOnly=C)},null,8,["modelValue"]),a(U,null,{default:t(()=>[m(g(e(o)("page.charts.options.bannedOnly")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),default:t(()=>[a(k,null,{default:t(()=>[m(g(e(o)("page.charts.options.more")),1)]),_:1})]),_:1})]),default:t(()=>[n.value?(y(),v(p,{key:0,status:"500",title:e(o)("page.charts.error.title"),class:"chart chart-error"},{subtitle:t(()=>[m(g(n.value.message),1)]),extra:t(()=>[a(i,{type:"primary",onClick:s[0]||(s[0]=()=>{n.value=void 0,e(O)()})},{default:t(()=>[m(g(e(o)("page.charts.error.refresh")),1)]),_:1})]),_:1},8,["title"])):(y(),v(e(Y),{key:1,class:"chart",option:u.value,loading:e(x),autoresize:"","loading-options":c.value,theme:e(l).isDark?"dark":"light","init-options":{renderer:"svg"}},null,8,["option","loading","loading-options","theme"]))]),_:1},8,["title"])}}}),pe=I({__name:"banTrends",props:{downloader:{}},setup(b){const{t:o}=E(),l=T(()=>({text:o("page.charts.loading"),color:n.isDark?"rgb(60, 126, 255)":"rgb(22, 93, 255)",textColor:n.isDark?"rgba(255, 255, 255, 0.9)":"rgb(29, 33, 41)",maskColor:n.isDark?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.4)"})),n=Q(),r=P();K([Z,le,ie,ee]);const c=b,u=te({range:[D().startOf("day").add(-7,"day").toDate(),new Date]}),_=T(()=>h.value),h=P({xAxis:{type:"time",max:"dataMax"},yAxis:{type:"value"},tooltip:{trigger:"axis",backgroundColor:n.isDark?"#333335":"",borderColor:n.isDark?"#333335":"",textStyle:{color:n.isDark?"rgba(255, 255, 255, 0.7)":""}},grid:{left:"15%"},series:[{data:[],type:"line",name:o("page.charts.line.options.field")}],backgroundColor:n.isDark?"rgba(0, 0, 0, 0.0)":void 0});ae(u,d=>{w(d.range[0],d.range[1],c.downloader)});const{loading:x,run:w,refresh:O}=N(Fe,{defaultParams:[D().startOf("day").add(-7,"day").toDate(),new Date,c.downloader],onSuccess:d=>{d.data&&(h.value.series[0].data=d.data.sort((s,i)=>s.key-i.key).map(s=>[new Date(s.key),s.value]))},onError:d=>{r.value=d}});return(d,s)=>{const i=oe,p=re,k=X,f=J,V=ne,S=z,A=F,L=M;return y(),v(L,{hoverable:"",title:e(o)("page.charts.title.line")},{extra:t(()=>[a(V,null,{content:t(()=>[a(f,{model:u},{default:t(()=>[a(k,{field:"range",label:e(o)("page.charts.options.days"),"label-col-flex":"100px"},{default:t(()=>[a(p,{modelValue:u.range,"onUpdate:modelValue":s[0]||(s[0]=U=>u.range=U),"show-time":"","value-format":"Date",shortcuts:[{label:e(o)("page.charts.options.shortcut.7days"),value:()=>[e(D)().startOf("day").add(-7,"day").toDate(),new Date]},{label:e(o)("page.charts.options.shortcut.14days"),value:()=>[e(D)().startOf("day").add(-14,"day").toDate(),new Date]},{label:e(o)("page.charts.options.shortcut.30days"),value:()=>[e(D)().startOf("day").add(-30,"day").toDate(),new Date]}]},null,8,["modelValue","shortcuts"])]),_:1},8,["label"])]),_:1},8,["model"])]),default:t(()=>[a(i,null,{default:t(()=>[m(g(e(o)("page.charts.options.more")),1)]),_:1})]),_:1})]),default:t(()=>[r.value?(y(),v(A,{key:0,status:"500",title:e(o)("page.charts.error.title"),class:"chart chart-error"},{subtitle:t(()=>[m(g(r.value.message),1)]),extra:t(()=>[a(S,{type:"primary",onClick:s[1]||(s[1]=()=>{r.value=void 0,e(O)()})},{default:t(()=>[m(g(e(o)("page.charts.error.refresh")),1)]),_:1})]),_:1},8,["title"])):(y(),v(e(Y),{key:1,class:"chart",option:_.value,loading:e(x),"loading-options":l.value,theme:e(n).isDark?"dark":"ovilia-green",autoresize:"","init-options":{renderer:"svg"}},null,8,["option","loading","loading-options","theme"]))]),_:1},8,["title"])}}}),ue=I({__name:"fieldPie",props:{downloader:{}},setup(b){const{t:o}=E();K([Z,se,ve,ee]);const l=Q(),n=te({field:"peerId",enableThreshold:!0,mergeSameVersion:!1}),r=T(()=>({text:o("page.charts.loading"),color:l.isDark?"rgb(60, 126, 255)":"rgb(22, 93, 255)",textColor:l.isDark?"rgba(255, 255, 255, 0.9)":"rgb(29, 33, 41)",maskColor:l.isDark?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.4)"})),c=P(),u=T(()=>_.value),_=P({tooltip:{trigger:"item",appendToBody:!0,formatter:'<p style="word-wrap:break-all"><b>{b}</b></p>  {c} ({d}%)',backgroundColor:l.isDark?"#333335":"",borderColor:l.isDark?"#333335":"",textStyle:{color:l.isDark?"rgba(255, 255, 255, 0.7)":""}},legend:{orient:"vertical",left:"right",type:"scroll",right:10,top:20,bottom:20,data:[],textStyle:{overflow:"truncate",width:100},tooltip:{show:!0}},backgroundColor:l.isDark?"rgba(0, 0, 0, 0.0)":void 0,series:[{name:o("page.charts.options.field."+n.field),type:"pie",radius:"55%",center:["50%","60%"],data:[],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]});ae(n,d=>{w(d.field,d.enableThreshold,h.downloader)});const h=b,{loading:x,run:w,refresh:O}=N(je,{defaultParams:["peerId",!0,h.downloader],onSuccess:d=>{if(d.data){const s=d.data.map(i=>(i.data===""&&(i.data=o("page.charts.options.field.empty")),i));if(n.mergeSameVersion&&n.field==="peerId"){const i=new Map;s.forEach(p=>{let k=p.data;const f=k.match(/^([-]?[a-zA-z]+)[0-9]+.*/);f&&(f==null?void 0:f.length)>=2&&(k=f[1]+"*"),i.has(k)?i.set(k,i.get(k)+p.count):i.set(k,p.count)}),_.value.legend.data=[],_.value.series[0].data=[],Array.from(i).forEach(([p,k])=>{_.value.legend.data.push(p),_.value.series[0].data.push({name:p,value:k})})}else _.value.legend.data=s.map(i=>i.data),_.value.series[0].data=s.map(i=>({name:i.data,value:i.count}))}},onError:d=>{c.value=d}});return(d,s)=>{const i=z,p=F,k=oe,f=_e,V=fe,S=X,A=he,L=ye,U=be,$=J,q=ne,W=M;return y(),v(W,{hoverable:"",title:e(o)("page.charts.options.field."+n.field)},{extra:t(()=>[a(q,null,{content:t(()=>[a($,{model:n,style:{width:"25vh"}},{default:t(()=>[a(S,{field:"field",label:e(o)("page.charts.options.field")},{default:t(()=>[a(V,{modelValue:n.field,"onUpdate:modelValue":s[1]||(s[1]=R=>n.field=R),"trigger-props":{autoFitPopupMinWidth:!0}},{default:t(()=>[a(f,{value:"peerId"},{default:t(()=>[m(g(e(o)("page.charts.options.field.peerId")),1)]),_:1}),a(f,{value:"torrentName"},{default:t(()=>[m(g(e(o)("page.charts.options.field.torrentName")),1)]),_:1}),a(f,{value:"module"},{default:t(()=>[m(g(e(o)("page.charts.options.field.module")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(S,{field:"enableThreshold"},{default:t(()=>[a(U,null,{default:t(()=>[a(A,{modelValue:n.enableThreshold,"onUpdate:modelValue":s[2]||(s[2]=R=>n.enableThreshold=R)},null,8,["modelValue"]),a(L,null,{default:t(()=>[m(g(e(o)("page.charts.options.thresold")),1)]),_:1})]),_:1})]),_:1}),n.field==="peerId"?(y(),v(S,{key:0,field:"mergeSameVersion"},{default:t(()=>[a(U,null,{default:t(()=>[a(A,{modelValue:n.mergeSameVersion,"onUpdate:modelValue":s[3]||(s[3]=R=>n.mergeSameVersion=R)},null,8,["modelValue"]),a(L,null,{default:t(()=>[m(g(e(o)("page.charts.options.mergeSame")),1)]),_:1})]),_:1})]),_:1})):Le("",!0)]),_:1},8,["model"])]),default:t(()=>[a(k,null,{default:t(()=>[m(g(e(o)("page.charts.options.more")),1)]),_:1})]),_:1})]),default:t(()=>[c.value?(y(),v(p,{key:0,status:"500",title:e(o)("page.charts.error.title"),class:"chart chart-error"},{subtitle:t(()=>[m(g(c.value.message),1)]),extra:t(()=>[a(i,{type:"primary",onClick:s[0]||(s[0]=()=>{c.value=void 0,e(O)()})},{default:t(()=>[m(g(e(o)("page.charts.error.refresh")),1)]),_:1})]),_:1},8,["title"])):(y(),v(e(Y),{key:1,class:"chart",option:u.value,loading:e(x),autoresize:"","loading-options":r.value,theme:e(l).isDark?"dark":"light","init-options":{renderer:"svg"}},null,8,["option","loading","loading-options","theme"]))]),_:1},8,["title"])}}}),qe=I({__name:"plusWarpper",props:{title:{}},setup(b){const o=Re(()=>ke(()=>import("./dummyChart-BZmTvoEA.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)),{t:l}=E(),n=j(),r=T(()=>n.plusStatus),c=()=>{n.emitter.emit("open-plus-modal")};return(u,_)=>{var d;const h=Be,x=z,w=F,O=M;return(d=r.value)!=null&&d.activated?Ue(u.$slots,"default",{key:0},void 0,!0):(y(),v(O,{key:1,hoverable:"",title:u.title},{default:t(()=>[a(w,{class:"overlay",status:"warning",title:e(l)("page.charts.locked")},{icon:t(()=>[a(h)]),subtitle:t(()=>[m(g(e(l)("page.charts.locked.tips")),1)]),extra:t(()=>[a(x,{type:"primary",onClick:c},{default:t(()=>[m(g(e(l)("page.charts.locked.active")),1)]),_:1})]),_:1},8,["title"]),a(e(o))]),_:1},8,["title"]))}}}),B=De(qe,[["__scopeId","data-v-0b577f3a"]]),me=I({__name:"traffic",props:{downloader:{}},setup(b){K([Z,se,Pe,ie,le,ee]);const o=te({range:[D().startOf("day").add(-14,"day").toDate(),new Date]}),l=Q(),n=T(()=>({text:r("page.charts.loading"),color:l.isDark?"rgb(60, 126, 255)":"rgb(22, 93, 255)",textColor:l.isDark?"rgba(255, 255, 255, 0.9)":"rgb(29, 33, 41)",maskColor:l.isDark?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.4)"})),{t:r,d:c}=E(),u=P(),_=T(()=>h.value),h=P({tooltip:{trigger:"axis",axisPointer:{type:"shadow"},backgroundColor:l.isDark?"#333335":"",borderColor:l.isDark?"#333335":"",textStyle:{color:l.isDark?"rgba(255, 255, 255, 0.7)":""},formatter:function(i){return c(i[0].data[0],"short")+":<br/>"+i.map(p=>`${p.marker} ${p.seriesName}: ${de(p.data[1])}`).join("<br>")}},backgroundColor:l.isDark?"rgba(0, 0, 0, 0.0)":void 0,legend:{data:[r("page.charts.traffic.options.download"),r("page.charts.traffic.options.upload")]},xAxis:{type:"time",max:"dataMax",min:"dataMin",minInterval:3600*24*1e3},grid:{left:"15%"},yAxis:{type:"value",axisLabel:{formatter:i=>de(i)}},series:[{name:r("page.charts.traffic.options.download"),type:"line",emphasis:{focus:"series"},data:[]},{name:r("page.charts.traffic.options.upload"),type:"line",emphasis:{focus:"series"},data:[]}]});ae(o,i=>{O(i.range[0],i.range[1],x.downloader)});const x=b,{loading:w,run:O,refresh:d,data:s}=N(Ne,{defaultParams:[D().startOf("day").add(-7,"day").toDate(),new Date,x.downloader],onSuccess:i=>{i.data&&(h.value.series[0].data=i.data.map(p=>[new Date(p.timestamp),p.dataOverallDownloaded]),h.value.series[1].data=i.data.map(p=>[new Date(p.timestamp),p.dataOverallUploaded]))},onError:i=>{u.value=i}});return(i,p)=>{const k=oe,f=re,V=X,S=J,A=xe,L=Se,U=ne,$=z,q=F,W=Oe,R=M;return y(),v(R,{hoverable:"",title:e(r)("page.charts.title.traffic")},{extra:t(()=>[a(U,null,{content:t(()=>[a(S,{model:o},{default:t(()=>[a(V,{field:"range",label:e(r)("page.charts.options.days"),"label-col-flex":"100px"},{default:t(()=>[a(f,{modelValue:o.range,"onUpdate:modelValue":p[0]||(p[0]=C=>o.range=C),"show-time":"","value-format":"Date",shortcuts:[{label:e(r)("page.charts.options.shortcut.7days"),value:()=>[e(D)().startOf("day").add(-7,"day").toDate(),new Date]},{label:e(r)("page.charts.options.shortcut.14days"),value:()=>[e(D)().startOf("day").add(-14,"day").toDate(),new Date]},{label:e(r)("page.charts.options.shortcut.30days"),value:()=>[e(D)().startOf("day").add(-30,"day").toDate(),new Date]}]},null,8,["modelValue","shortcuts"])]),_:1},8,["label"])]),_:1},8,["model"])]),default:t(()=>[a(k,null,{default:t(()=>[m(g(e(r)("page.charts.options.more")),1)]),_:1}),a(L,{content:e(r)("page.charts.tooltip.traffic")},{default:t(()=>[a(A)]),_:1},8,["content"])]),_:1})]),default:t(()=>{var C;return[u.value?(y(),v(q,{key:0,status:"500",title:e(r)("page.charts.error.title"),class:"chart chart-error"},{subtitle:t(()=>[m(g(u.value.message),1)]),extra:t(()=>[a($,{type:"primary",onClick:p[1]||(p[1]=()=>{u.value=void 0,e(d)()})},{default:t(()=>[m(g(e(r)("page.charts.error.refresh")),1)]),_:1})]),_:1},8,["title"])):!((C=e(s))!=null&&C.data)&&!e(w)?(y(),v(W,{key:1,class:"chart",style:{"align-items":"center",display:"flex","justify-content":"center","flex-direction":"column"}})):(y(),v(e(Y),{key:2,class:"chart",option:_.value,loading:e(w),"loading-options":n.value,theme:e(l).isDark?"dark":"ovilia-green",autoresize:"","init-options":{renderer:"svg"}},null,8,["option","loading","loading-options","theme"]))]}),_:1},8,["title"])}}}),ge=I({__name:"trends",props:{downloader:{}},setup(b){K([ie,Z,le,ee]);const{t:o}=E(),l=te({range:[D().startOf("day").add(-14,"day").toDate(),new Date]}),n=P(),r=Q(),c=T(()=>({text:o("page.charts.loading"),color:r.isDark?"rgb(60, 126, 255)":"rgb(22, 93, 255)",textColor:r.isDark?"rgba(255, 255, 255, 0.9)":"rgb(29, 33, 41)",maskColor:r.isDark?"rgba(0, 0, 0, 0.4)":"rgba(255, 255, 255, 0.4)"})),u=T(()=>_.value),_=P({xAxis:{type:"time",max:"dataMax"},yAxis:{type:"value"},tooltip:{trigger:"axis",backgroundColor:r.isDark?"#333335":"",borderColor:r.isDark?"#333335":"",textStyle:{color:r.isDark?"rgba(255, 255, 255, 0.7)":""}},backgroundColor:r.isDark?"rgba(0, 0, 0, 0.0)":void 0,series:[{data:[],type:"line",color:"#A5A051",areaStyle:{color:"#A5A051"},name:o("page.charts.trends.options.peers")},{data:[],type:"line",color:"#DB4D6D",areaStyle:{color:"#DB4D6D"},name:o("page.charts.trends.options.bans")}]});ae(l,d=>{w(d.range[0],d.range[1],h.downloader)});const h=b,{loading:x,run:w,refresh:O}=N(Me,{defaultParams:[D().startOf("day").add(-7,"day").toDate(),new Date,h.downloader],onSuccess:d=>{d.data&&(_.value.series[0].data=d.data.connectedPeersTrend.sort((s,i)=>s.key-i.key).map(s=>[new Date(s.key),s.value]),_.value.series[1].data=d.data.bannedPeersTrend.sort((s,i)=>s.key-i.key).map(s=>[new Date(s.key),s.value]))},onError:d=>{n.value=d}});return(d,s)=>{const i=re,p=X,k=J,f=z,V=F,S=M;return y(),v(S,{hoverable:"",title:e(o)("page.charts.title.trends")},{extra:t(()=>[a(k,{model:l,"auto-label-width":""},{default:t(()=>[a(p,{field:"range",label:e(o)("page.charts.options.days"),style:{"margin-bottom":"0"}},{default:t(()=>[a(i,{modelValue:l.range,"onUpdate:modelValue":s[0]||(s[0]=A=>l.range=A),"value-format":"Date",style:{width:"275px"},shortcuts:[{label:e(o)("page.charts.options.shortcut.7days"),value:()=>[e(D)().startOf("day").add(-7,"day").toDate(),new Date]},{label:e(o)("page.charts.options.shortcut.14days"),value:()=>[e(D)().startOf("day").add(-14,"day").toDate(),new Date]},{label:e(o)("page.charts.options.shortcut.30days"),value:()=>[e(D)().startOf("day").add(-30,"day").toDate(),new Date]}]},null,8,["modelValue","shortcuts"])]),_:1},8,["label"])]),_:1},8,["model"])]),default:t(()=>[n.value?(y(),v(V,{key:0,status:"500",title:e(o)("page.charts.error.title"),class:"chart chart-error"},{subtitle:t(()=>[m(g(n.value.message),1)]),extra:t(()=>[a(f,{type:"primary",onClick:s[1]||(s[1]=()=>{n.value=void 0,e(O)()})},{default:t(()=>[m(g(e(o)("page.charts.error.refresh")),1)]),_:1})]),_:1},8,["title"])):(y(),v(e(Y),{key:1,class:"chart",option:u.value,loading:e(x),"loading-options":c.value,theme:e(r).isDark?"dark":"ovilia-green",autoresize:"","init-options":{renderer:"svg"}},null,8,["option","loading","loading-options","theme"]))]),_:1},8,["title"])}}}),Je=I({__name:"index",setup(b){const{t:o}=E(),{data:l}=N(we);return(n,r)=>{const c=Ve,u=Te,_=Ae,h=Ce;return y(),v(h,{"default-active-key":0,"lazy-load":"",animation:"",type:"rounded"},{default:t(()=>{var x;return[(y(),v(_,{key:0,title:e(o)("page.charts.all")},{default:t(()=>[a(u,{justify:"center",align:"stretch",wrap:!0,gutter:[{xs:12,sm:12,md:12,lg:12,xl:24},{xs:12,sm:12,md:12,lg:12,xl:24}]},{default:t(()=>[a(c,{xl:12,lg:24,md:24,sm:24,xs:24},{default:t(()=>[a(pe)]),_:1}),a(c,{xl:12,lg:24,md:24,sm:24,xs:24},{default:t(()=>[a(ue)]),_:1}),a(c,{xl:12,lg:24,md:24,sm:24,xs:24},{default:t(()=>[a(B,{title:e(o)("page.charts.title.geoip")},{default:t(()=>[a(ce)]),_:1},8,["title"])]),_:1}),a(c,{xl:12,lg:24,md:24,sm:24,xs:24},{default:t(()=>[a(B,{title:e(o)("page.charts.title.traffic")},{default:t(()=>[a(me)]),_:1},8,["title"])]),_:1}),a(c,{xl:24,lg:24,md:24,sm:24,xs:24},{default:t(()=>[a(B,{title:e(o)("page.charts.title.trends")},{default:t(()=>[a(ge)]),_:1},8,["title"])]),_:1})]),_:1})]),_:1},8,["title"])),(y(!0),Ie($e,null,Ee(((x=e(l))==null?void 0:x.data)??[],(w,O)=>(y(),v(_,{key:O+1,title:w.name},{default:t(()=>[a(u,{justify:"center",align:"stretch",wrap:!0,gutter:[{xs:12,sm:12,md:12,lg:12,xl:24},{xs:12,sm:12,md:12,lg:12,xl:24}]},{default:t(()=>[a(c,{xl:12,lg:24,md:24,sm:24,xs:24},{default:t(()=>[a(pe,{downloader:w.name},null,8,["downloader"])]),_:2},1024),a(c,{xl:12,lg:24,md:24,sm:24,xs:24},{default:t(()=>[a(ue,{downloader:w.name},null,8,["downloader"])]),_:2},1024),a(c,{xl:12,lg:24,md:24,sm:24,xs:24},{default:t(()=>[a(B,{title:e(o)("page.charts.title.geoip")},{default:t(()=>[a(ce,{downloader:w.name},null,8,["downloader"])]),_:2},1032,["title"])]),_:2},1024),a(c,{xl:12,lg:24,md:24,sm:24,xs:24},{default:t(()=>[a(B,{title:e(o)("page.charts.title.traffic")},{default:t(()=>[a(me,{downloader:w.name},null,8,["downloader"])]),_:2},1032,["title"])]),_:2},1024),a(c,{xl:24,lg:24,md:24,sm:24,xs:24},{default:t(()=>[a(B,{title:e(o)("page.charts.title.trends")},{default:t(()=>[a(ge,{downloader:w.name},null,8,["downloader"])]),_:2},1032,["title"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["title"]))),128))]}),_:1})}}});export{Je as default};
